serenity {
    take.screenshots = FOR_FAILURES
    #take.screenshots = AFTER_EACH_STEP

    parallel.tests = 4
    fork.count = 2
    batch.size = 2
}

# Configuraciones de Cucumber Parallel
cucumber.execution.parallel.enabled=true
cucumber.execution.parallel.config.strategy=fixed
cucumber.execution.parallel.config.fixed.parallelism=4
cucumber.glue=com.serenitybdd.yourstoreapp.stepdefinitions
cucumber.features=src/test/resources/features

logging.level.net.serenitybdd = INFO
logging.level.com.serenitybbd.yourstoreapp = INFO

#Webdriver acorde al sistema operativo en que se necesite correr el script local
drivers {
  windows {
    webdriver.chrome.driver = "src/test/resources/webdriver/windows/chromedriver.exe"
  }
  mac {
    webdriver.chrome.driver = "src/test/resources/webdriver/mac/chromedriver"
  }
  linux {
    webdriver.chrome.driver = "src/test/resources/webdriver/linux/chromedriver"
  }
}

environments {
    default = "dev"
    dev {
        environment.name = "Development"
        app.url = "http://opencart.abstracta.us/"
        webdriver.base.url = "http://opencart.abstracta.us/"
    }

    test {
        environment.name = "Quality"
        app.url = "https://test.opencart.abstracta.us/"
        webdriver.base.url = "https://test.opencart.abstracta.us/"
    }

    prod {
        environment.name = "Production"
        app.url = "https://www.opencart.abstracta.us/"
        webdriver.base.url = "https://www.opencart.abstracta.us/"
    }

    linux_chrome_local {
        webdriver {
          driver = chrome
          autodownload = false
          use.unique.browser = false

            capabilities {
            browserName = "chrome"
            acceptInsecureCerts = true
            "goog:chromeOptions" {
              args = ["--headless", "remote-debugging-port=0", "remote-allow-origins=*","test-type", "no-sandbox",
                      "ignore-certificate-errors", "--window-size=1920,1080", "incognito", "disable-infobars",
                      "disable-gpu", "disable-default-apps", "disable-popup-blocking", "disable-dev-shm-usage",
                      "disable-extensions", "disable-web-security", "disable-translate", "disable-logging"]
            }
          }
        }
    }

    windows_chrome_bs {
        webdriver {
            driver = remote
            remote.url = "https://hub-cloud.browserstack.com/wd/hub"

            capabilities {
                browserName = "Chrome"
                acceptInsecureCerts = true
                "bstack:options" {
                  userName = "username_xxxxx"
                  accessKey = "es6zTzpYSXUD8JcXCsNk"
                  os = "Windows"
                  osVersion = "11"
                  browserVersion = "latest"
                  resolution = "1920x1080"
                  projectName = "Your Store App"
                  buildName = "windows_edge"
                  local = false
                  video = true
                  debug = true
                  networkLogs = true
                  consoleLogs = "info"
                  idleTimeout = 300
                }
                "goog:chromeOptions" {
                    args = ["start-maximized", "test-type", "no-sandbox", "disable-popup-blocking"]
                }
            }
        }
    }

    windows_edge_bs {
        webdriver {
            driver = remote
            remote.url = "https://hub-cloud.browserstack.com/wd/hub"
            capabilities {
                browserName = "Edge"
                acceptInsecureCerts = true
                "bstack:options" {
                   userName = "username_xxxxx"
                   accessKey = "es6zTzpYSXUD8JcXCsNk"
                   os = "Windows"
                   osVersion = "10"
                   browserVersion = "latest"
                   resolution = "1920x1080"
                   projectName = "Your Store App"
                   buildName = "windows_edge"
                   local = false
                   video = true
                   debug = true
                   networkLogs = true
                   consoleLogs = "info"
                   idleTimeout = 300
                }
                "ms:edgeOptions" {
                    args = ["start-maximized", "test-type", "no-sandbox", "disable-popup-blocking"]
                }
            }
        }
    }

    windows_firefox {
        webdriver {
            driver = remote
            remote.url = "https://hub-cloud.browserstack.com/wd/hub"

            capabilities {
                browserName = "Firefox"
                acceptInsecureCerts = true
                "bstack:options" {
                    userName = "username_xxxxx"
                    accessKey = "es6zTzpYSXUD8JcXCsNk"
                    os = "Windows"
                    osVersion = "11"
                    browserVersion = "latest"
                    resolution = "1920x1080"
                    projectName = "Your Store App"
                    buildName = "windows_firefox"
                    local = false
                    video = true
                    debug = true
                    networkLogs = true
                    consoleLogs = "info"
                    idleTimeout = 300
                }
                "moz:firefoxOptions" {
                    args = ["-private"]
                }
            }
        }
    }

    mac_catalina_safari {
        webdriver {
            driver = remote
            remote.url = "https://hub-cloud.browserstack.com/wd/hub"

            capabilities {
                browserName = "Safari"
                acceptInsecureCerts = true
                "bstack:options" {
                    userName = "username_xxxxx"
                    accessKey = "es6zTzpYSXUD8JcXCsNk"
                    os = "OS X"
                    osVersion = "Catalina"
                    browserVersion = "13.1"
                    projectName = "Your Store App"
                    buildName = "mac_catalina_safari"
                    local = false
                    video = true
                    debug = true
                    networkLogs = true
                    consoleLogs = "info"
                    idleTimeout = 300
                }
            }
        }
    }

    samsung_mobile_chrome {
        webdriver {
            driver = remote
            remote.url = "https://hub-cloud.browserstack.com/wd/hub"

            capabilities {
                browserName = "chrome"
                acceptInsecureCerts = true
                "bstack:options" {
                    userName = "username_xxxxx"
                    accessKey = "es6zTzpYSXUD8JcXCsNk"

                    deviceName = "Samsung Galaxy S23 Ultra"
                    osVersion = "13.0"
                    realMobile = true

                    projectName = "Your Store App"
                    buildName = "samsung_mobile_chrome"
                    sessionName = "Build_Default"
                    local = false
                    video = true
                    debug = true
                    networkLogs = true
                    consoleLogs = "info"
                    idleTimeout = 300
                }
                "goog:chromeOptions" {
                    args = ["ignore-certificate-errors", "incognito", "disable-popup-blocking", "disable-translate","disable-web-security"]
                }
            }
        }
    }

    iphone_mobile_safari {
        webdriver {
            driver = remote
            remote.url = "https://hub-cloud.browserstack.com/wd/hub"
            capabilities {
                browserName = "safari"
                acceptInsecureCerts = true
                "bstack:options" {
                    userName = "username_xxxxx"
                    accessKey = "es6zTzpYSXUD8JcXCsNk"

                    deviceName = "iPhone 15 Pro Max"
                    osVersion = "17"
                    realMobile = true

                    projectName = "Your Store App"
                    buildName = "iphone_mobile_safari"
                    local = false
                    video = true
                    debug = true
                    networkLogs = true
                    consoleLogs = "info"
                    idleTimeout = 300
                }
            }
        }
    }

    iphone_mobile_chrome {
        webdriver {
            driver = remote
            remote.url = "https://hub-cloud.browserstack.com/wd/hub"
            capabilities {
                browserName = "chrome"
                acceptInsecureCerts = true
                "bstack:options" {
                    userName = "username_xxxxx"
                    accessKey = "es6zTzpYSXUD8JcXCsNk"

                    deviceName = "iPhone 15 Pro Max"
                    osVersion = "17"
                    realMobile = true

                    projectName = "Your Store App"
                    buildName = "iphone_mobile_safari"
                    local = false
                    video = false
                    debug = true
                    networkLogs = true
                    consoleLogs = "info"
                    idleTimeout = 300
                }
            }
        }
   }
}